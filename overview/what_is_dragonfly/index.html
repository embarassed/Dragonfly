<!DOCTYPE html>
<html lang="en" class="js csstransforms3d">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="generator" content="Hugo 0.47" />
    <meta name="description" content="DragonFly Documentation">
<meta name="author" content="Team Dragonfly">

    <link rel="shortcut icon" href="/images/favicon.png" type="image/x-icon" />
<link rel="icon" href="/images/favicon.png" type="image/x-icon" />
    <title>What Is Dragonfly? :: DragonFly Documentation</title>

    
    <link href="/css/nucleus.css?1542412591" rel="stylesheet">
    <link href="/css/fontawesome-all.min.css?1542412591" rel="stylesheet">
    <link href="/css/hybrid.css?1542412591" rel="stylesheet">
    <link href="/css/featherlight.min.css?1542412591" rel="stylesheet">
    <link href="/css/perfect-scrollbar.min.css?1542412591" rel="stylesheet">
    <link href="/css/auto-complete.css?1542412591" rel="stylesheet">
    <link href="/css/theme.css?1542412591" rel="stylesheet">
    <link href="/css/hugo-theme.css?1542412591" rel="stylesheet">
    
      <link href="/css/theme-dragonfly.css?1542412591" rel="stylesheet">
    

    <script src="/js/jquery-2.x.min.js?1542412591"></script>

    <style type="text/css">
      :root #header + #content > #left > #rlblock_left{
          display:none !important;
      }
      
    </style>
    
  </head>
  <body class="" data-url="/overview/what_is_dragonfly/">
    <nav id="sidebar" class="showVisitedLinks">



  <div id="header-wrapper">
    <div id="header">
      <img src="https://raw.githubusercontent.com/aliware-os/dragonfly-test/gh-pages/images/logo.png"  alt="Dragonfly Logo" />
    </div>
    
        <div class="searchbox">
    <label for="search-by"><i class="fas fa-search"></i></label>
    <input data-search-input id="search-by" type="text" placeholder="Search...">
    <span data-search-clear=""><i class="fas fa-close"></i></span>
</div>

<script type="text/javascript" src="/js/lunr.min.js?1542412591"></script>
<script type="text/javascript" src="/js/auto-complete.js?1542412591"></script>
<script type="text/javascript">
    
        var baseurl = "https:\/\/d7y.io";
    
</script>
<script type="text/javascript" src="/js/search.js?1542412591"></script>

    
  </div>

    <div class="highlightable">
    <ul class="topics">

        
          
          


 
  
    
    <li data-nav-id="/onboarding/" title="Before Starting" class="dd-item 
        
        
        
        ">
      <a href="/onboarding/">
          <b>0. </b>Before Starting
          
            <i class="fas read-icon"></i>
          
      </a>
      
              
    </li>
  
 

          
          


 
  
    
    <li data-nav-id="/overview/" title="Overview" class="dd-item 
        parent
        
        
        ">
      <a href="/overview/">
          <b>1. </b>Overview
          
            <i class="fas read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
          
          
        
          
            
            


 
  
    
      <li data-nav-id="/overview/what_is_dragonfly/" title="What Is Dragonfly?" class="dd-item active">
        <a href="/overview/what_is_dragonfly/">
        What Is Dragonfly?
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/overview/terminology/" title="Terminology" class="dd-item ">
        <a href="/overview/terminology/">
        Terminology
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
        
        </ul>
              
    </li>
  
 

          
          


 
  
    
    <li data-nav-id="/quick_start/" title="Quick Start" class="dd-item 
        
        
        
        ">
      <a href="/quick_start/">
          <b>2. </b>Quick Start
          
            <i class="fas read-icon"></i>
          
      </a>
      
              
    </li>
  
 

          
          


 
  
    
    <li data-nav-id="/user_guide/" title="User Guide" class="dd-item 
        
        
        
        ">
      <a href="/user_guide/">
          <b>3. </b>User Guide
          
            <i class="fas read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
          
          
        
          
            
            


 
  
    
      <li data-nav-id="/user_guide/install_server/" title="Installing Server" class="dd-item ">
        <a href="/user_guide/install_server/">
        Installing Server
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/user_guide/install_client/" title="Installing Client" class="dd-item ">
        <a href="/user_guide/install_client/">
        Installing Client
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/user_guide/download_files/" title="Downloading Files" class="dd-item ">
        <a href="/user_guide/download_files/">
        Downloading Files
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/user_guide/supernode_configuration/" title="Supernode Configuration" class="dd-item ">
        <a href="/user_guide/supernode_configuration/">
        Supernode Configuration
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
        
        </ul>
              
    </li>
  
 

          
          


 
  
    
    <li data-nav-id="/cli_reference/" title="CLI Reference" class="dd-item 
        
        
        
        ">
      <a href="/cli_reference/">
          <b>4. </b>CLI Reference
          
            <i class="fas read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
          
          
        
          
            
            


 
  
    
      <li data-nav-id="/cli_reference/dfdaemon/" title="dfdaemon" class="dd-item ">
        <a href="/cli_reference/dfdaemon/">
        dfdaemon
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/cli_reference/dfget/" title="dfget" class="dd-item ">
        <a href="/cli_reference/dfget/">
        dfget
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
        
        </ul>
              
    </li>
  
 

          
          


 
  
    
    <li data-nav-id="/api_reference/" title="APIs Provided by Supernode" class="dd-item 
        
        
        
        ">
      <a href="/api_reference/">
          <b>5. </b>API Reference
          
            <i class="fas read-icon"></i>
          
      </a>
      
              
    </li>
  
 

          
          


 
  
    
    <li data-nav-id="/faq/" title="FAQ" class="dd-item 
        
        
        
        ">
      <a href="/faq/">
          <b>6. </b>FAQ
          
            <i class="fas read-icon"></i>
          
      </a>
      
              
    </li>
  
 

          
         
    </ul>

    
    
      <section id="shortcuts">
        <h3>More</h3>
        <ul>
          
              <li> 
                  <a class="padding" href="https://d7y.io"><i class='fab fa-fw fa-github'></i> View on Github</a>
              </li>
          
              <li> 
                  <a class="padding" href="https://d7y.io/roadmap"><i class='fas fa-fw fa-map-signs'></i> Roadmap</a>
              </li>
          
        </ul>
      </section>
    

    
    <section id="prefooter">
      <hr/>
      <ul>
      
      
      
        <li><a class="padding" href="#" data-clear-history-toggle=""><i class="fas fa-history fa-fw"></i> Clear History</a></li>
      
      </ul>
    </section>
    
    <section id="footer">
      <p>Built with <a href="https://github.com/matcornic/hugo-theme-learn"><i class="fas fa-heart"></i></a> from <a href="http://getgrav.org">Grav</a> and <a href="http://gohugo.io/">Hugo</a></p>

    </section>
  </div>
</nav>





        <section id="body">
        <div id="overlay"></div>
        <div class="padding highlightable">
              
              <div>
                <div id="top-bar">
                
                  
                  
                  
                  <div id="top-github-link">
                    <a class="github-link" title='Edit this page' href="https://github.com/alibaba/Dragonfly/edit/master/docs/overview/what_is_dragonfly.md" target="blank">
                      <i class="fas fa-code-branch"></i>
                      <span id="top-github-link-text">Edit this page</span>
                    </a>
                  </div>
                  
                
                
                <div id="breadcrumbs" itemscope="" itemtype="http://data-vocabulary.org/Breadcrumb">
                    <span id="sidebar-toggle-span">
                        <a href="#" id="sidebar-toggle" data-sidebar-toggle="">
                          <i class="fas fa-bars"></i>
                        </a>
                    </span>
                  
                  <span id="toc-menu"><i class="fas fa-list-alt"></i></span>
                  
                  <span class="links">
                 
                 
                    
          
          
            
            
          
          
            
            
          
          
            <a href='/'>Dragonfly</a> > <a href='/overview/'>Overview</a> > What Is Dragonfly?
          
         
          
         
          
        
                 
                  </span>
                </div>
                
                    <div class="progress">
    <div class="wrapper">
<nav id="TableOfContents">
<ul>
<li>
<ul>
<li><a href="#why-dragonfly">Why Dragonfly</a></li>
<li><a href="#how-does-it-stack-up-against-traditional-solution">How Does It Stack Up Against Traditional Solution?</a></li>
<li><a href="#how-does-it-work">How Does It Work?</a>
<ul>
<li><a href="#downloading-general-files">Downloading General Files</a></li>
<li><a href="#downloading-container-images">Downloading Container Images</a></li>
<li><a href="#downloading-blocks">Downloading Blocks</a></li>
</ul></li>
</ul></li>
</ul>
</nav>
    </div>
</div>

                
              </div>
            </div>
            

        
        <div id="body-inner">
          
            <h1>What Is Dragonfly?</h1>
          

        


<p>Dragonfly is an intelligent P2P-based image and file distribution tool. It aims to improve the efficiency and success rate of file transferring, and maximize the usage of network bandwidth, especially for the distribution of larget amounts of data, such as application distribution, cache distribution, log distribution, and image distribution.
</p>

<p>At Alibaba, every month Dragonfly is invoked two billion times and distributes 3.4PB of data. Dragonfly has become one of the most important pieces of infrastructure at Alibaba.</p>

<p>While container technologies makes DevOps life easier most of the time, it surely brings some challenges: for example the efficiency of image distribution, especially when you have to replicate image distribution on several hosts.</p>

<p>Dragonfly works extremely well with both Docker and <a href="https://github.com/alibaba/pouch">PouchContainer</a> in this scenario. It&rsquo;s also compatible with containers of other formats. It delivers up to 57 times the throughput of native docker and saves up to 99.5% of the out bandwidth of registry.</p>

<p>Dragonfly makes it simple and cost-effective to set up, operate, and scale any kind of file, image, or data distribution.</p>

<h2 id="why-dragonfly">Why Dragonfly</h2>

<p>This project is an open-source version of the Dragonfly used at Alibaba. It has the following features:</p>

<p><strong>Note:</strong> More Alibaba-internal features will be made available to open-source users soon. Stay tuned!</p>

<ul>
<li><strong>P2P-based file distribution</strong>: By using the P2P technology for file transmission, it makes the most out of the bandwidth resources of each peer to improve downloading efficiency,  and saves a lot of cross-IDC bandwidth, especially the costly cross-board bandwidth.</li>
<li><strong>Non-invasive support to all kinds of container technologies</strong>: Dragonfly can seamlessly support various containers for distributing images.</li>
<li><strong>Host level speed limit</strong>: In addition to rate limit for the current download task like many other downloading tools (for example wget and curl), Dragonfly also provides rate limit for the entire host.</li>
<li><strong>Passive CDN</strong>: The CDN mechanism can avoid repetitive remote downloads.</li>
<li><strong>Strong consistency</strong>: Dragonfly can make sure that all downloaded files are consistent even if users do not provide any check code (MD5).</li>
<li><strong>Disk protection and highly efficient IO</strong>: Prechecking disk space, delaying synchronization, writing file blocks in the best order, isolating net-read/disk-write, and so on.</li>
<li><strong>High performance</strong>: Cluster Manager is completely closed-loop, which means that it doesn&rsquo;t rely on any database or distributed cache, processing requests with extremely high performance.</li>
<li><strong>Auto-isolation of Exception</strong>: Dragonfly will automatically isolate exception nodes (peer or Cluster Manager) to improve download stability.</li>
<li><strong>No pressure on file source</strong>: Generally, only a few Cluster Managers will download files from the source.</li>
<li><strong>Support standard HTTP header</strong>: Support submitting authentication information through HTTP header.</li>
<li><strong>Effective concurrency control of Registry Auth</strong>: Reduce the pressure on the Registry Auth Service.</li>
<li><strong>Simple and easy to use</strong>: Very few configurations are needed.</li>
</ul>

<h2 id="how-does-it-stack-up-against-traditional-solution">How Does It Stack Up Against Traditional Solution?</h2>

<p>We carried out an experiment to compare the performance of Dragonfly and wget.</p>

<table>
<thead>
<tr>
<th>Test Environment</th>
<th></th>
</tr>
</thead>

<tbody>
<tr>
<td>Dragonfly Server</td>
<td>2 * (24-Core 64GB-RAM 2000Mb/s)</td>
</tr>

<tr>
<td>File Source Server</td>
<td>2 * (24-Core 64GB-RAM 2000Mb/s)</td>
</tr>

<tr>
<td>Client</td>
<td>4-Core 8GB-RAM 200Mb/s</td>
</tr>

<tr>
<td>Target File Size</td>
<td>200MB</td>
</tr>

<tr>
<td>Experiment Date</td>
<td>April 20, 2016</td>
</tr>
</tbody>
</table>

<p>The expeirment result is as shown in the following figure.</p>

<p><img src="../../images/performance.png" alt="How it stacks up" /></p>

<p>As you can see in the chart, for Dragonfly, no matter how many clients are downloading, the average downloading time is always about 12 seconds. But for wget, the downloading time keeps increasing with the number of clients. When the number of wget clients reaches 1,200, the file source crashed and therefore cannot serve any client.</p>

<h2 id="how-does-it-work">How Does It Work?</h2>

<p>Dragonfly works slightly differently when downloading general files and downloading container images.</p>

<h3 id="downloading-general-files">Downloading General Files</h3>

<p>The Cluster Manager is also called a supernode, which is responsible for CDN and scheduling every peer to transfer blocks between each other. dfget is the P2P client, which is also called &ldquo;peer&rdquo;. It&rsquo;s mainly used to download and share blocks.</p>

<p><img src="../../images/dfget.png" alt="Downloading General Files" /></p>

<h3 id="downloading-container-images">Downloading Container Images</h3>

<p>Registry is similar to the file server above. dfget proxy is also called dfdaemon, which intercepts HTTP requests from docker pull or docker push, and then decides which requests to process with dfget.</p>

<p><img src="../../images/dfget-combine-container.png" alt="Downloading Container Images" /></p>

<h3 id="downloading-blocks">Downloading Blocks</h3>

<p>Every file is divided into multiple blocks, which are transmitted between peers. Each peer is a P2P client. Cluster Manager will check if the corresponding file exists in the local disk. If not, it will be downloaded into Cluster Manager from file server.</p>

<p><img src="../../images/distributing.png" alt="How file blocks are downloaded" /></p>

<footer class=" footline" >
	
</footer>


        
        </div> 
        

      </div>

    <div id="navigation">
        
        
        
        
            
            
                
                    
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                        
                        
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                        
                        
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
        
        


	 
	 
		
			<a class="nav nav-prev" href="/overview/" title="Overview"> <i class="fa fa-chevron-left"></i></a>
		
		
			<a class="nav nav-next" href="/overview/terminology/" title="Terminology" style="margin-right: 0px;"><i class="fa fa-chevron-right"></i></a>
		
	
    </div>

    </section>
    
    <div style="left: -1000px; overflow: scroll; position: absolute; top: -1000px; border: none; box-sizing: content-box; height: 200px; margin: 0px; padding: 0px; width: 200px;">
      <div style="border: none; box-sizing: content-box; height: 200px; margin: 0px; padding: 0px; width: 200px;"></div>
    </div>
    <script src="/js/clipboard.min.js?1542412592"></script>
    <script src="/js/perfect-scrollbar.min.js?1542412592"></script>
    <script src="/js/perfect-scrollbar.jquery.min.js?1542412592"></script>
    <script src="/js/jquery.sticky.js?1542412592"></script>
    <script src="/js/featherlight.min.js?1542412592"></script>
    <script src="/js/html5shiv-printshiv.min.js?1542412592"></script>
    <script src="/js/highlight.pack.js?1542412592"></script>
    <script>hljs.initHighlightingOnLoad();</script>
    <script src="/js/modernizr.custom.71422.js?1542412592"></script>
    <script src="/js/learn.js?1542412592"></script>
    <script src="/js/hugo-learn.js?1542412592"></script>

    <link href="/mermaid/mermaid.css?1542412592" type="text/css" rel="stylesheet" />
    <script src="/mermaid/mermaid.js?1542412592"></script>
    <script>
        mermaid.initialize({ startOnLoad: true });
    </script>
    

  </body>
</html>

